architecture:
    data_flow: |
        CLI parses args via cobra -> config loaded via viper -> context gathered
        (git, files, history) -> provider selected from manager -> prompt sent to
        AI API -> response formatted for terminal display
    key_files:
        - path: cmd/how/main.go
          role: Entry point, calls cli.Execute()
        - path: internal/cli/root.go
          role: Root command, flag handling, prompt dispatch - add new flags here
        - path: internal/config/config.go
          role: Config struct definitions and load/save - add new config fields here
        - path: pkg/providers/interface.go
          role: Provider interface - implement this to add new AI providers
        - path: internal/manager/factory.go
          role: Provider registration - register new providers here
    pattern: layered with provider abstraction
codebase_map:
    directories:
        cmd/how:
            entry: main.go
            path: cmd/how
            purpose: Application entry point
        internal/cli:
            path: internal/cli
            purpose: CLI commands and handlers (root, setup, history, install, providers)
        internal/config:
            path: internal/config
            purpose: Configuration loading, saving, and types (viper-based)
        internal/context:
            path: internal/context
            purpose: Context gathering (git, files, shell history, project detection)
        internal/manager:
            path: internal/manager
            purpose: Provider lifecycle management and factory pattern
        pkg/extractor:
            path: pkg/extractor
            purpose: Command extraction from LLM responses
        pkg/providers:
            path: pkg/providers
            purpose: Provider interface and types (shared across implementations)
        pkg/providers/anthropic:
            path: pkg/providers/anthropic
            purpose: Anthropic Claude provider implementation
        pkg/text:
            path: pkg/text
            purpose: Terminal text formatting and markdown rendering
        pkg/version:
            path: pkg/version
            purpose: Version information (set via ldflags)
commands:
    build: make build
    clean: make clean
    deps: make deps
    dev: make dev
    fmt: make fmt
    install: make install
    lint: make lint
    test: make test
common_tasks:
    add_ai_provider:
        - Create package in pkg/providers/newprovider/
        - Implement providers.Provider interface
        - Register in internal/cli/root.go initConfig() with manager.RegisterProvider()
        - Add provider option in internal/cli/setup.go runSetup()
    add_cli_command:
        - Create new file in internal/cli/ (e.g., mycommand.go)
        - Define cobra.Command with Use, Short, Long, Run
        - Register in root.go init() with rootCmd.AddCommand(myCmd)
    add_config_field:
        - Add field to appropriate struct in internal/config/config.go
        - Use yaml struct tags for YAML serialization
        - Access via cfg.FieldName after config load
    add_context_source:
        - Add gather method in internal/context/context.go
        - Call from GatherAll() based on config flags
        - Add config option in ContextConfig struct
conventions:
    file_organization: |
        Standard Go project layout: cmd/ for entry points, internal/ for private
        packages, pkg/ for public/reusable packages
    naming:
        constants: camelCase for package-level, UPPER_SNAKE avoided
        files: lowercase single words (root.go, config.go, manager.go)
        functions: PascalCase for exported, camelCase for internal
        packages: lowercase single words matching directory
    patterns:
        - 'Provider pattern: implement providers.Provider interface, register in factory'
        - Config uses viper with YAML and HOW_ env prefix for overrides
        - Internal packages (internal/) for app-specific code
        - Shared packages (pkg/) for reusable components
        - 'Error handling: wrap errors with fmt.Errorf and %w'
        - CLI subcommands as separate files in internal/cli/
development:
    run: make dev && ./bin/how
    setup:
        - make deps
        - make setup-dev
project:
    description: AI-powered shell assistant for commands, explanations, and code generation
    framework: cobra
    name: how
    primary_language: go
    type: cli
tech_stack:
    framework: cobra for CLI
    key_libraries:
        - name: spf13/cobra
          purpose: CLI framework for commands and flags
        - name: spf13/viper
          purpose: Configuration management with YAML files
        - name: AlecAivazis/survey/v2
          purpose: Interactive terminal prompts for setup wizard
        - name: briandowns/spinner
          purpose: Loading spinner during AI requests
        - name: fatih/color
          purpose: Terminal color output
    package_manager: go modules
    runtime: go 1.22.4
testing:
    framework: go test
    location: '*_test.go files alongside source'
    patterns:
        - Standard Go testing with go test ./...
        - Race detection available via make test-race
    run: make test
